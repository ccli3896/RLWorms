library(reticulate)
library(tidyverse)
library(pacman)
pacman::p_load(devtools,RcppArmadillo)
library(BART)
setwd("Research/20_09_07_NewPC/RLWorms/02_08_Trees/")
source("./worm-sampling/worm-sampling/utils.R")
# PARAMETERS
episodes = 1
start_ep = 0
num_save = 500
num_tree = 100
temp = 1 # temperature
# Fixed params
n = 12
n_dim = 2
imp_dims = 1:n_dim
error_scale = 20 # rough scale of observation error (sd for specific value)
dim_regularization = 3 # higher values -> more smoothness & sparsity
# Start by formatting for R.
np <- import("numpy")
folder = "./Data/03_08_0/" #######################
fbase = paste(folder,"traj",sep="")
fname <- paste(fbase,ind,".npy",sep="")
source('~/get_posterior_bart.R')
source('~/get_posterior_bart.R')
fit$yhat.test
fit
# Making tree and saving
fit <-  wbart(m_bart, d_bart$obs, x.test=m_pred,
sparse=T, a=0.5*(1+1/length(imp_dims)), nskip=200,
ntree=num_tree, usequants=T, ndpost=num_save,
power=dim_regularization, sigest=error_scale, sigquant=0.1,
nkeeptest=500)
fit$yhat.test
dim(fit$yhat.test)
plot(fit$yhat.test.mean)
np$save(paste(folder,"bart",ind,".npy",sep=""),fit$y_hat_test)
np$save(paste(folder,"bart",ind,".npy",sep=""),fit$yhat.test)
source('~/get_posterior_bart.R')
source('~/get_posterior_bart.R')
source('~/get_posterior_bart.R')
source('~/get_posterior_bart.R')
